#!/bin/bash

# Generate CSV report of PokÃ©mon data with averages.

OUTPUT_FILE="pokemon_report.csv"

echo "Name,Height (m),Weight (kg)" > "$OUTPUT_FILE"

# Process each JSON file
for file in pokemon_data/*.json; do
    name=$(jq -r '.name' "$file" | sed 's/.*/\u&/') # sed used to capitalize
    height=$(jq '.height' "$file" | awk '{print $1/10}') # convert to meters
    weight=$(jq '.weight' "$file" | awk '{print $1/10}') # convert to kg

    echo "$name,$height,$weight" >> "$OUTPUT_FILE"
done

echo -e "\nCSV Report generated at: $OUTPUT_FILE\n"

# Calculate averages with awk
awk -F',' 'NR>1 {h+=$2; w+=$3; c++} 
END {print "Average Height: " h/c " m"; print "Average Weight: " w/c " kg"}' "$OUTPUT_FILE"
